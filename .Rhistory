"sphrs2", "polviews", "happy", "trust", "class", "income")
GSS.divorce <- GSS.complete[,var_list]
GSS.divorce <- GSS.complete[GSS.complete$year>=1990,var_list]
View(GSS.divorce)
rm( GSS.complete )
gc()
save(GSS.divorce , file = "GSSdivorce.rda")
load("GSS.complete.rda")
load("GSScomplete.rda")
View(GSS.divorce)
View(GSS.complete)
knitr::opts_chunk$set(echo = TRUE)
load("GSSdivorce.rda")
load("GSScomplete.rda")
head(GSS.complete)
View(GSS.complete)
View(GSS.divorce)
summary(happy)
summary(GSS.divorce$happy)
summary(GSS.divorce$trust)
summary(GSS.divorce$class)
summary(GSS.divorce)
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "martype", "partyid", "hapmar", "denom", "relig", "fund", "childs",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"sphrs2", "polviews", "happy", "trust", "class", "income")
GSS.divorce <- GSS.complete[GSS.complete$year>=1990,var_list]
summary(GSS.divorce)
summary(GSS.divorce$denom)
knitr::opts_chunk$set(echo = TRUE)
load("GSSdivorce.rda")
load("C:/Users/Sarah/Documents/GitHub/data-science-project/GSScomplete.rda")
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "partyid", "hapmar", "denom", "fund", "childs",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"polviews", "happy", "trust", "class", "income", "version")
GSS.divorce <- GSS.complete[GSS.complete$year>=1990,var_list]
rm( GSS.complete )
gc()
save(GSS.divorce , file = "GSSdivorce.rda")
colnames(GSS.divorce)
knitr::opts_chunk$set(echo = TRUE)
load("GSSdivorce.rda")
GSS.divorce.na <- GSS.divorce
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "divorce",
"widowed", "educ", "wrkstat", "spwrksta", "polviews", "happy", "trust",
"class", "income", "version")
colnames(GSS.divorce)
print(var_list)
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "divorce",
"educ", "wrkstat", "spwrksta", "polviews", "happy", "trust",
"class", "income", "version")
GSS.divorce <- GSS.divorce.na[,var_list]
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
GSS.divorce.v1 <- GSS.divorce[GSS.divorce$version==1,]
GSS.divorce.v2 <- GSS.divorce[GSS.divorce$version==2,]
GSS.divorce.v3 <- GSS.divorce[GSS.divorce$version==3,]
GSS.divorce.v4 <- GSS.divorce[GSS.divorce$version==4,]
GSS.divorce.v5 <- GSS.divorce[GSS.divorce$version==5,]
GSS.divorce.v6 <- GSS.divorce[GSS.divorce$version==6,]
GSS.divorce.complete1 <- GSS.divorce.v1[complete.cases(GSS.divorce.v1),]
View(GSS.divorce.complete1)
View(GSS.divorce.v1)
GSS.divorce.na <- GSS.divorce
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "educ", "wrkstat",
"spwrksta", "polviews", "happy", "trust", "class", "income", "version")
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
GSS.divorce.v1 <- GSS.divorce[GSS.divorce$version==1,]
summary(GSS.divorce.v1$marital)
View(GSS.divorce.v2)
View(GSS.divorce.v3)
View(GSS.divorce.v4)
View(GSS.divorce.v5)
View(GSS.divorce.v6)
load("GSSdivorce.rda")
GSS.divorce.na <- GSS.divorce
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "educ", "wrkstat",
"spwrksta", "polviews", "happy", "trust", "class", "income", "version")
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
keeps <- c("MARRIED", "DIVORCED", "SEPARATED")
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital==(keeps), ]
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital==keeps, ]
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital=="MARRIED" | "DIVORCED" | "SEPARATED", ]
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital==("MARRIED" | "DIVORCED" | "SEPARATED"), ]
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital=="MARRIED" | GSS.divorce.na$marital=="DIVORCED" | GSS.divorce.na$marital=="SEPARATED", ]
View(GSS.divorce)
View(GSS.divorce)
load("GSSdivorce.rda")
GSS.divorce.na <- GSS.divorce
View(GSS.divorce)
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "educ", "wrkstat",
"spwrksta", "polviews", "happy", "trust", "class", "income", "version")
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
View(GSS.divorce)
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce.na$marital=="DIVORCED" | GSS.divorce.na$marital=="SEPARATED", ]
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce$marital=="DIVORCED" | GSS.divorce$marital=="SEPARATED", ]
View(GSS.divorce)
library(ggplot2)
premar <- ggplot(GSS.divorce, aes(x="premarsx", y="marital"))
ggplot(GSS.divorce, aes(x="premarsx", y="marital"))
premarcounts <- table(GSS.divorce$marital, GSS.divorce$premarsx)
premar <- ggplot(premarcounts, col=c("darkblue", "lightblue", "lightgreen")
premar <- ggplot(premarcounts, col=c("darkblue", "lightblue", "lightgreen"))
premar <- barplot(premarcounts, col=c("darkblue", "lightblue", "lightgreen"))
premar <- ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar(aes(fill=GSS.divorce$premarsx))
ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar(aes(fill=GSS.divorce$premarsx))
premar <- ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar()
ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar()
premar <- ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar(stat="count")
ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar(stat="count")
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=GSS.divorce$premarsx)) +  geom_bar(fill=GSS.divorce$premarsx)
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=GSS.divorce$premarsx)) +  geom_bar()
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, fill=GSS.divorce$premarsx)) +  hist()
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, fill=GSS.divorce$premarsx))
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=GSS.divorce$premarsx))
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=GSS.divorce$premarsx))
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=GSS.divorce$premarsx)) + geom_bar(stat = "identity")
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=variable)) + geom_bar(stat = "identity") + facet_grid(~samp)
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=variable)) + geom_bar(stat = "identity")
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=GSS.divorce$premarsx, fill=GSS.divorce$premarsx)) + geom_bar(stat = "identity")
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$premarsx))
View(tab)
colnames(tab) <- c("Marital Status", "Premarital Sex Opinion", "count")
pie_1 <- ggplot(tab, aes(status, premarital)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on premarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, premarital)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on premarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
colnames(tab) <- c("status", "premarital", "count")
ggplot(tab, aes(status, premarital)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on premarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
summary(GSS.divorce$marital)
summary(GSS.divorce$premarsx)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$pornlaw))
colnames(tab) <- c("status", "porn", "count")
pie_2 <- ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on pornography regulation?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on pornography regulation?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$xmarsex))
colnames(tab) <- c("status", "exmar", "count")
pie_3 <- ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on extramarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on extramarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
pie_3 <- ggplot(tab, aes(status, exmar)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on extramarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, exmar)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on extramarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$partyid))
colnames(tab) <- c("status", "party", "count")
pie_4 <- ggplot(tab, aes(status, party)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Party identification?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, party)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Party identification?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$happy))
colnames(tab) <- c("status", "happy", "count")
pie_5 <- ggplot(tab, aes(status, happy)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("How happy are you?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, happy)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("How happy are you?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$fund))
colnames(tab) <- c("status", "fund", "count")
pie_6 <- ggplot(tab, aes(status, fund)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Fundamentalism of religion?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, fund)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Fundamentalism of religion?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$class))
colnames(tab) <- c("status", "class", "count")
pie_7 <- ggplot(tab, aes(status, class)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Self-identified class?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, class)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Self-identified class?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$wrkstat))
colnames(tab) <- c("status", "work", "count")
pie_8 <- ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Work status?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Work status?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
pie_8 <- ggplot(tab, aes(status, work)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Work status?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, work)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Work status?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$educ))
colnames(tab) <- c("status", "edu", "count")
pie_2 <- ggplot(tab, aes(status, edu)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Years of education?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, edu)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Years of education?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$childs))
colnames(tab) <- c("status", "child", "count")
pie_2 <- ggplot(tab, aes(status, child)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Children?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, child)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Children?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$pornlaw))
colnames(tab) <- c("status", "age", "count")
pie_11 <- ggplot(tab, aes(status, age)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, age)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$age))
colnames(tab) <- c("status", "age", "count")
pie_11 <- ggplot(tab, aes(status, age)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, age)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$sexeduc))
colnames(tab) <- c("status", "sexed", "count")
pie_11 <- ggplot(tab, aes(status, sexed)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, sexed)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$region))
colnames(tab) <- c("status", "region", "count")
pie_12 <- ggplot(tab, aes(status, region)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Region?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, region)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Region?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
setwd("/Users/Sarah/Documents/Github/data-science-project/")
library(foreign)
load("C:/Users/Sarah/Documents/GitHub/data-science-project/GSScomplete.rda")
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "partyid", "hapmar", "denom", "fund", "childs", "degree",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"polviews", "happy", "trust", "class", "income", "version", "reg16",
"family16", "famdif16", "born", "parborn", "income98", "size", "attend",
"relig16", "bible", "helpful", "fair", "consci", "satjob", "satfin",
"abnomore", "absingle", "divlaw", "xmovie", "fefam")
GSS.divorce <- GSS.complete[GSS.complete$year>=1990,var_list]
GSS.divorce$Agecat1<-cut(GSS.divorce$age, c(0,18,25,35,45,55,65,75,85,95))
rm( GSS.complete )
gc()
save(GSS.divorce , file = "GSSdivorce.rda")
load("GSSdivorce.rda")
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce$marital=="DIVORCED" | GSS.divorce$marital=="SEPARATED", ]
GSS.divorce$marital <- factor(GSS.divorce$marital)
library(ggplot2)
library(plyr)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$reg16))
colnames(tab) <- c("status", "region16", "count")
pie_20 <- ggplot(tab, aes(status, region16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Region at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, region16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Region at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$family16))
colnames(tab) <- c("status", "family16", "count")
pie_21 <- ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$famdif16))
colnames(tab) <- c("status", "familyif16", "count")
pie_1 <- ggplot(tab, aes(status, familyif16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("If not with both parents, why?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, familyif16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("If not with both parents, why?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, familyif16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("If not with both parents, why?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$family16))
colnames(tab) <- c("status", "family16", "count")
pie_21 <- ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
#remove sphrs2, agewed, martype
GSS.divorce.na <- GSS.divorce
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996, ]
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce$marital=="DIVORCED" | GSS.divorce$marital=="SEPARATED", ]
GSS.divorce
GSS.divorce$marital <- factor(GSS.divorce$marital)
GSS.divorce$marital2 <- "married"
GSS.divorce$marital2 [GSS.divorce$marital == "SEPARATED"] <- "split"
GSS.divorce$marital2 [GSS.divorce$marital == "DIVORCED"] <- "split"
GSS.divorce$marital2 [is.na(GSS.divorce$marital) ==T] <- NA
GSS.divorce$marital2 <- factor(GSS.divorce$marital2)
GSSnew <- GSS.divorce[!is.na(GSS.divorce$marital2),]
summary(GSSnew$marital2)
GSS.divorce.na <- GSS.divorce
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996, ]
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce$marital=="DIVORCED" | GSS.divorce$marital=="SEPARATED", ]
GSS.divorce
GSS.divorce$marital <- factor(GSS.divorce$marital)
GSS.divorce$marital2 <- "married"
GSS.divorce$marital2 [GSS.divorce$marital == "SEPARATED"] <- "split"
GSS.divorce$marital2 [GSS.divorce$marital == "DIVORCED"] <- "split"
load("GSSdivorce.rda")
#remove sphrs2, agewed, martype
GSS.divorce.na <- GSS.divorce
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996, ]
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce$marital=="DIVORCED" | GSS.divorce$marital=="SEPARATED", ]
GSS.divorce
GSS.divorce$marital <- factor(GSS.divorce$marital)
GSS.divorce$marital2 <- "married"
GSS.divorce$marital2 [GSS.divorce$marital == "SEPARATED"] <- "split"
GSS.divorce$marital2 [GSS.divorce$marital == "DIVORCED"] <- "split"
GSS.divorce$marital2 [is.na(GSS.divorce$marital) ==T] <- NA
GSS.divorce$marital2 <- factor(GSS.divorce$marital2)
GSSnew <- GSS.divorce[!is.na(GSS.divorce$marital2),]
summary(GSSnew$marital2)
GSS.A <- subset(GSSnew, (GSSnew$version==1|GSSnew$version==4))
GSS.B <- subset(GSSnew, (GSSnew$version==2|GSSnew$version==5))
GSS.C <- subset(GSSnew, (GSSnew$version==3|GSSnew$version==6))
set.seed(567)
rand <- runif(nrow(GSS.A))
trainA <- GSS.A[rand>0.3,]
validA <- GSS.A[rand>0.15 & rand <0.3,]
testA <- GSS.A[rand<0.15,]
set.seed(678)
rand <- runif(nrow(GSS.B))
trainB <- GSS.B[rand>0.3,]
validB <- GSS.B[rand>0.15 & rand <0.3,]
testB <- GSS.B[rand<0.15,]
set.seed(789)
rand <- runif(nrow(GSS.C))
trainC <- GSS.C[rand>0.3,]
validC <- GSS.C[rand>0.15 & rand <0.3,]
testC <- GSS.C[rand<0.15,]
?dist
dist.mat.A <- dist(trainA, method = "euclidean")
clusters.a <- hclust(dist.mat.A)
?cutree
tree.a <- cutree(clusters.a, k=2)
plot(cut(as.dendrogram(clusters.a), h=0)$upper, leaflab="none")
tree.a2 <- cutree(clusters.a, k=8)
tree.a
head(tree.a2)
head(tree.a)
?cut.dendrogram
summary(tree.a)
summary(tree.a2)
View(trainA)
colnames(trainA)
clusters.vars.A <- c("year", "sexeduc", "region", "premarsx", "xmarsex", "partyid", "fund", "childs",  "degree", "Agecat1", "widowed", "educ", "wrkstat", "spwrksta", "polviews", "happy", "trust", "class",    "reg16", "family16", "famdif16", "born", "parborn", "income98", "size", "attend", "relig16", "bible",    "satfin", "abnomore", "absingle", "divlaw", "fefam", "marital2")
clusters.train.a <- trainA[,clusters.vars.A]
View(clusters.train.a)
clusters.vars.A <- c("year", "sexeduc", "region", "premarsx", "xmarsex", "partyid", "fund", "childs",  "degree", "Agecat1", "widowed", "educ", "wrkstat", "polviews", "happy", "trust", "class",    "reg16", "family16", "famdif16", "born", "parborn", "income98", "size", "attend", "relig16", "bible",    "satfin", "abnomore", "absingle", "divlaw", "fefam", "marital2")
clusters.train.a <- trainA[,clusters.vars.A]
dist.mat.A <- dist(clusters.train.a, method = "euclidean")
clusters.a <- hclust(dist.mat.A)
tree.a <- cutree(clusters.a, k=2)
plot(cut(as.dendrogram(clusters.a), h=0)$upper, leaflab="none")
plot(cut(as.dendrogram(clusters.a), h=10000)$upper, leaflab="none")
plot(cut(as.dendrogram(clusters.a), h=5000)$upper, leaflab="none")
plot(cut(as.dendrogram(clusters.a), h=4000)$upper, leaflab="none")
plot(cut(as.dendrogram(clusters.a), h=2000)$upper, leaflab="none")
?dist
dist.mat.A2 <- dist(clusters.train.a, method = "manhattan")
clusters.a2 <- hclust(dist.mat.A)
plot(cut(as.dendrogram(clusters.a2), h=0)$upper, leaflab="none")
plot(cut(as.dendrogram(clusters.a2), h=2000)$upper, leaflab="none")
dist.mat.A2 <- dist(clusters.train.a, method = "manhattan")
clusters.a2 <- hclust(dist.mat.A2)
plot(cut(as.dendrogram(clusters.a2), h=2000)$upper, leaflab="none")
dist.mat.A3 <- dist(clusters.train.a, method = "maximum")
clusters.a3 <- hclust(dist.mat.A3)
plot(cut(as.dendrogram(clusters.a3), h=2000)$upper, leaflab="none")
plot(cut(as.dendrogram(clusters.a3), h=0)$upper, leaflab="none")
clusters.a3
summary(clusters.a3)
summary(clusters.a2)
table(tree.a)
tree.a2 <- cutree(clusters.a2, k=2)
table(tree.a2)
tree.a3 <- cutree(clusters.a3, k=2)
table(tree.a3)
load("GSSdivorce.rda")
View(GSS.divorce)
load("C:/Users/Sarah/Documents/GitHub/data-science-project/GSScomplete.rda")
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "partyid", "hapmar", "denom", "fund", "childs", "degree",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"polviews", "happy", "trust", "class", "income", "version", "reg16",
"family16", "famdif16", "born", "parborn", "income91", "size", "attend",
"relig16", "bible", "helpful", "fair", "consci", "satjob", "satfin",
"abnomore", "absingle", "divlaw", "xmovie", "fefam")
GSS.divorce <- GSS.complete[GSS.complete$year>=1996,var_list]
GSS.divorce$Agecat1<-cut(GSS.divorce$age, c(0,18,25,35,45,55,65,75,85,95))
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce$marital=="DIVORCED" | GSS.divorce$marital=="SEPARATED", ]
GSS.divorce$marital <- factor(GSS.divorce$marital)
GSS.divorce$marital2 <- "married"
GSS.divorce$marital2 [GSS.divorce$marital == "SEPARATED"] <- "split"
GSS.divorce$marital2 [GSS.divorce$marital == "DIVORCED"] <- "split"
GSS.divorce$marital2 [is.na(GSS.divorce$marital) ==T] <- NA
GSS.divorce$marital2 <- factor(GSS.divorce$marital2)
GSSnew <- GSS.divorce[!is.na(GSS.divorce$marital2),]
summary(GSSnew$marital2)
rm( GSS.complete )
gc()
save(GSS.divorce , file = "GSSdivorce.rda")
rm(GSS.divorce)
save(GSS.divorce , file = "GSSdivorce.rda")
load("GSSdivorce.rda")
clusters.vars.A <- c("year", "sexeduc", "region", "premarsx", "xmarsex", "partyid", "fund", "childs",  "degree", "Agecat1", "widowed", "educ", "wrkstat", "polviews", "happy", "trust", "class",    "reg16", "family16", "famdif16", "born", "parborn", "income91", "size", "attend", "relig16", "bible",    "satfin", "abnomore", "absingle", "divlaw", "fefam", "marital2")
clusters.train.a <- trainA[,clusters.vars.A]
GSS.A <- subset(GSSnew, (GSSnew$version==1|GSSnew$version==4))
GSS.B <- subset(GSSnew, (GSSnew$version==2|GSSnew$version==5))
GSS.C <- subset(GSSnew, (GSSnew$version==3|GSSnew$version==6))
set.seed(567)
rand <- runif(nrow(GSS.A))
trainA <- GSS.A[rand>0.3,]
validA <- GSS.A[rand>0.15 & rand <0.3,]
testA <- GSS.A[rand<0.15,]
set.seed(678)
rand <- runif(nrow(GSS.B))
trainB <- GSS.B[rand>0.3,]
validB <- GSS.B[rand>0.15 & rand <0.3,]
testB <- GSS.B[rand<0.15,]
set.seed(789)
rand <- runif(nrow(GSS.C))
trainC <- GSS.C[rand>0.3,]
validC <- GSS.C[rand>0.15 & rand <0.3,]
testC <- GSS.C[rand<0.15,]
clusters.vars.A <- c("year", "sexeduc", "region", "premarsx", "xmarsex", "partyid", "fund", "childs",  "degree", "Agecat1", "widowed", "educ", "wrkstat", "polviews", "happy", "trust", "class",    "reg16", "family16", "famdif16", "born", "parborn", "income91", "size", "attend", "relig16", "bible",    "satfin", "abnomore", "absingle", "divlaw", "fefam", "marital2")
clusters.train.a <- trainA[,clusters.vars.A]
dist.mat.A <- dist(clusters.train.a, method = "euclidean")
clusters.a <- hclust(dist.mat.A)
dist.mat.A2 <- dist(clusters.train.a, method = "manhattan")
?dist
clusters.train.a <- complete.cases(trainA[,clusters.vars.A])
clusters.train.a <- trainA[complete.cases(trainA),clusters.vars.A]
View(trainA)
clusters.train.a <- trainA[,clusters.vars.A]
clusters.train.a <- clusters.train.a[complete.cases(clusters.train.a),]
clusters.train.a <- trainA[,clusters.vars.A]
View(clusters.train.a)
load("C:/Users/Sarah/Documents/GitHub/data-science-project/GSScomplete.rda")
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "partyid", "hapmar", "denom", "fund", "childs", "degree",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"polviews", "happy", "trust", "class", "income", "version", "reg16",
"family16", "famdif16", "born", "parborn", "income91", "income98", "size", "attend",
"relig16", "bible", "helpful", "fair", "consci", "satjob", "satfin",
"abnomore", "absingle", "divlaw", "xmovie", "fefam")
GSS.divorce <- GSS.complete[GSS.complete$year>=1996,var_list]
GSS.divorce$Agecat1<-cut(GSS.divorce$age, c(0,18,25,35,45,55,65,75,85,95))
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce$marital=="DIVORCED" | GSS.divorce$marital=="SEPARATED", ]
GSS.divorce$marital <- factor(GSS.divorce$marital)
GSS.divorce$marital2 <- "married"
GSS.divorce$marital2 [GSS.divorce$marital == "SEPARATED"] <- "split"
GSS.divorce$marital2 [GSS.divorce$marital == "DIVORCED"] <- "split"
GSS.divorce$marital2 [is.na(GSS.divorce$marital) ==T] <- NA
GSS.divorce$marital2 <- factor(GSS.divorce$marital2)
GSSnew <- GSS.divorce[!is.na(GSS.divorce$marital2),]
summary(GSSnew$marital2)
rm( GSS.complete )
gc()
save(GSS.divorce , file = "GSSdivorce.rda")
sum(is.na(GSS.divorce$income))
sum(is.na(GSS.divorce$income91))
sum(is.na(GSS.divorce$income98))
