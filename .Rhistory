library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
pad <- function(vec){
x <- c()
y <- c()
for(i in vec){
if (i<10){
x <- c(x, paste0("0", i))
}
else {
y <- c(y, as.character(i))
}
}
output <- c(x,y)
return(output)
}
year <- seq(0,15) %>% pad()
month <- seq(1,12) %>% pad()
df <- expand.grid(year,month)
dates <- c(paste0(df$Var1,df$Var2))
permits <- c()
txt1 <- tempfile()
for(i in dates) {
url1 <- paste0("http://www2.census.gov/econ/bps/Metro/ma",i,"c.txt")
download.file(url1, txt1, mode="wb")
permits <-rbind(permits, read.csv(txt1, header=FALSE, skip=4)[,c(1,5,6)])
}
sum(is.na(permits))
# there are no NA; if there were, use na.omit
permitmeans <- aggregate(permits[, 3], list(permits[,2]), mean)
names(permitmeans) <- c("msa", "mean")
write.csv(permitmeans, "C:/Users/Sarah/SkyDrive/Documents/Georgetown/PPOL 670/sarah-unbehaun-hmwk1.csv")
library(foreign)
read.xport("C:\Users\Sarah\Downloads\FSAS76\accident.ssd")
accident76 <- read.xport("C:\Users\Sarah\Downloads\FSAS76\accident.ssd")
accident76 <- read.xport("C:/Users/Sarah/Downloads/FSAS76/accident.ssd")
accident76 <- read.xport("C:/Users/Sarah/Downloads/FSAS76.zip/accident.ssd")
accident76 <- read.ssd("C:/Users/Sarah/Downloads/FSAS76.zip/accident.ssd")
readLines("C:/Users/Sarah/Downloads/FSEQL00/TPLFin2000.Dat")
readLines("C:/Users/Sarah/Downloads/FSEQL00/TPLFin2000.Dat", n=10)
accident00 <- read.table("C:/Users/Sarah/Downloads/FSEQL00/TPLFin2000.Dat", header="TRUE")
accident00 <- read.table("C:/Users/Sarah/Downloads/FSEQL00/TPLFin2000.Dat")
accident00 <- read.dbf("C:/Users/Sarah/Downloads/FARSDBF00/ACCIDENT.dbf")
View(accident00)
str(accident00)
setwd("/Users/jeff/Documents/Github/data-science-project/")
setwd("/Users/Sarah/Documents/Github/data-science-project/")
setwd("/Users/Sarah/Documents/Github/data-science/lecture-09/data")
load("nyc311.Rda")
dim(nyc311)
colnames(nyc311)
summary(nyc311)
sumUp <- function(data, clusters, depth = 3, horizontal = FALSE){
# Summarize cluster variables by most frequent
#
# Args:
#       data: input data
#       clusters: vector of cluster labels
#       depth: top 3 most frequent variables
#       horizontal: control format of results. FALSE means one cluster per row.
#
# Returns:
#       A data frame of k-number of centroids
#
#Calculate means, rotate such that features = rows
overview <- aggregate(data, list(clusters), mean)
overview <- as.data.frame(cbind(colnames(overview)[2:ncol(overview)],
t(overview[,2:ncol(overview)])))
row.names(overview) <- 1:nrow(overview)
overview[,1] <- gsub("count.","",as.character(overview[,1]))
#Clean up values as numerics
for(i in 2:ncol(overview)){
overview[,i] <- round(as.numeric(as.character(overview[,i])),2)
}
#Get top X features
depth.temp <- data.frame()
for(i in 2:ncol(overview)){
temp <- overview[order(-overview[,i]), ]
temp <- paste("(",temp[,i], "): ", temp[,1], sep = "")
temp <- as.data.frame(matrix(temp[1:depth],
nrow = 1,
ncol = depth))
colnames(temp) <- paste0("Rank.", 1:depth)
depth.temp <- rbind(depth.temp, temp)
}
depth.temp <- cbind(data.frame(table(clusters)), depth.temp)
#Rotate?
if(horizontal == TRUE){
depth.temp <- t(depth.temp)
}
return(depth.temp)
}
clusters <- rep(1, nrow(nyc311))
clusters <- rep(1, nrow(nyc311)) #essentially the population average
sumUp(nyc311[,3:ncol(nyc311)], clusters, 10, horizontal = TRUE)
library(foreign)
nyc311.2 <- scale(nyc311[,c(3:ncol(nyc311))], scale = TRUE, center = TRUE)
master <- data.frame()
for(i in seq(3,50,3)){
print(i)
new <- kmeans(nyc311.2, i) #each i will be a centroid
master <- rbind(master,
data.frame(k = i,
ss = new$betweenss)) #extracts WSS statistic, bind to df
}
plot(master)
set.seed(20)
cluster <- kmeans(nyc311.2, 10)$cluster
palette(colorRampPalette(c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a'))(10))
op <- par(mar = rep(0, 4))
plot(nyc311$lon, nyc311$lat, col = factor(cluster), pch = 15, cex = 0.16,
frame.plot=FALSE, yaxt='n', ann=FALSE, xaxt='n')
legend(x="topleft", bty = "n", legend=levels(factor(cluster)),
cex = 1,  x.intersp=0, xjust=0, yjust=0, text.col=seq_along(levels(factor(cluster))))
par(op)
recap <- sumUp(nyc311[,3:ncol(nyc311)], cluster, 5)
View(recap)
temp <- tempfile()
download.file("http://gss.norc.org/documents/spss/GSS_spss.zip",temp, mode="wb")
unzipped <- unzip(temp, exdir=getwd())
GSS <- read.spss(unzipped[1])
nyc311.short <- nyc311[sample(1:nrow(nyc311), replace = FALSE, 10000), ]
nyc.short <- scale(nyc311.short[,3:ncol(nyc311.short)])
d <- dist(as.matrix(nyc.short), method = "euclidean")
hc <- hclust(d, method="ward.D")
plot(hc, main = "Hierarchical Clustering Example", cex = 0.001)
rect.hclust(hc, k=10, border="red")
groups <- cutree(hc, k=10) # cut tree into 5 clusters
groups <- cutree(hc, k=10) # cut tree into 5 clusters
palette(colorRampPalette(c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a'))(10))
op <- par(mar = rep(0, 4))
plot(nyc311.short$lon, nyc311.short$lat, col = factor(groups), pch = 15, cex = 0.2,
frame.plot=FALSE, yaxt='n', ann=FALSE, xaxt='n')
legend(x="topleft", bty = "n", legend=levels(factor(groups)),
cex = 1,  x.intersp=0, xjust=0, yjust=0, text.col=seq_along(levels(factor(groups))))
par(op)
recap <- sumUp(nyc311.short[,3:ncol(nyc311.short)], groups, 5)
View(recap)
setwd("/Users/Sarah/Documents/Github/data-science-project/")
filenames <- dir(unzipped, full.names=TRUE)
unzipped <- unzip(temp, exdir=getwd())
read.spss("C:/Users/Sarah/Documents/GSS_spss/GSS7214_R6b.sav")
GSS.complate <- read.spss("C:/Users/Sarah/Documents/GSS_spss/GSS7214_R6b.sav")
GSS.complete <- read.spss("C:/Users/Sarah/Documents/GSS_spss/GSS7214_R6b.sav", to.data.frame = TRUE)
GSS.complete <- read.spss("C:/Users/Sarah/Documents/GSS_spss/GSS7214_R6b.sav", to.data.frame = TRUE)
library(foreign)
GSS.complete <- read.spss("C:/Users/Sarah/Documents/GSS_spss/GSS7214_R6b.sav", to.data.frame = TRUE)
z <- GSS.complete
rm(GSS.complete )
gc()
GSS.complete <- z
rm( z )
gc()
save( GSS.complete , file = "GSScomplete.rda" )
head(GSS.complete)
vars <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id ", "ballot",
"year ", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw",
"partyid", "hapmar", "denom", "fund", "childs", "age", "marital",
"divorce", "widowed", "educ", "natdrug", "spwrksta", "sphrs2",
"polviews", "happy", "trust", "class", "income")
GSS.divorce <- GSS.complete[ , KeepVars ]
GSS.divorce <- GSS.complete[ , vars ]
GSS.divorce <- GSS.complete[, vars]
vars <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id ", "ballot",
"year ", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "martype", "partyid", "hapmar", "denom", "fund", "childs",
"age", "marital", "divorce", "widowed", "educ", "natdrug", "spwrksta",
"sphrs2", "polviews", "happy", "trust", "class", "income")
View(GSS.complete)
GSS.divorce <- GSS.complete[vars]
str(GSS.complete)
vars <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id ", "ballot",
"year ", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "martype", "partyid", "hapmar", "denom", "fund", "childs",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"sphrs2", "polviews", "happy", "trust", "class", "income")
GSS.divorce <- GSS.complete[,vars]
str(vars)
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id ", "ballot",
"year ", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "martype", "partyid", "hapmar", "denom", "fund", "childs",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"sphrs2", "polviews", "happy", "trust", "class", "income")
GSS.divorce <- GSS.complete[,var_list]
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "martype", "partyid", "hapmar", "denom", "fund", "childs",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"sphrs2", "polviews", "happy", "trust", "class", "income")
GSS.divorce <- GSS.complete[,var_list]
GSS.divorce <- GSS.complete[GSS.complete$year>=1990,var_list]
View(GSS.divorce)
rm( GSS.complete )
gc()
save(GSS.divorce , file = "GSSdivorce.rda")
load("GSS.complete.rda")
load("GSScomplete.rda")
View(GSS.divorce)
View(GSS.complete)
knitr::opts_chunk$set(echo = TRUE)
load("GSSdivorce.rda")
load("GSScomplete.rda")
head(GSS.complete)
View(GSS.complete)
View(GSS.divorce)
summary(happy)
summary(GSS.divorce$happy)
summary(GSS.divorce$trust)
summary(GSS.divorce$class)
summary(GSS.divorce)
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "martype", "partyid", "hapmar", "denom", "relig", "fund", "childs",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"sphrs2", "polviews", "happy", "trust", "class", "income")
GSS.divorce <- GSS.complete[GSS.complete$year>=1990,var_list]
summary(GSS.divorce)
summary(GSS.divorce$denom)
knitr::opts_chunk$set(echo = TRUE)
load("GSSdivorce.rda")
load("C:/Users/Sarah/Documents/GitHub/data-science-project/GSScomplete.rda")
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "partyid", "hapmar", "denom", "fund", "childs",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"polviews", "happy", "trust", "class", "income", "version")
GSS.divorce <- GSS.complete[GSS.complete$year>=1990,var_list]
rm( GSS.complete )
gc()
save(GSS.divorce , file = "GSSdivorce.rda")
colnames(GSS.divorce)
knitr::opts_chunk$set(echo = TRUE)
load("GSSdivorce.rda")
GSS.divorce.na <- GSS.divorce
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "divorce",
"widowed", "educ", "wrkstat", "spwrksta", "polviews", "happy", "trust",
"class", "income", "version")
colnames(GSS.divorce)
print(var_list)
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "divorce",
"educ", "wrkstat", "spwrksta", "polviews", "happy", "trust",
"class", "income", "version")
GSS.divorce <- GSS.divorce.na[,var_list]
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
GSS.divorce.v1 <- GSS.divorce[GSS.divorce$version==1,]
GSS.divorce.v2 <- GSS.divorce[GSS.divorce$version==2,]
GSS.divorce.v3 <- GSS.divorce[GSS.divorce$version==3,]
GSS.divorce.v4 <- GSS.divorce[GSS.divorce$version==4,]
GSS.divorce.v5 <- GSS.divorce[GSS.divorce$version==5,]
GSS.divorce.v6 <- GSS.divorce[GSS.divorce$version==6,]
GSS.divorce.complete1 <- GSS.divorce.v1[complete.cases(GSS.divorce.v1),]
View(GSS.divorce.complete1)
View(GSS.divorce.v1)
GSS.divorce.na <- GSS.divorce
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "educ", "wrkstat",
"spwrksta", "polviews", "happy", "trust", "class", "income", "version")
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
GSS.divorce.v1 <- GSS.divorce[GSS.divorce$version==1,]
summary(GSS.divorce.v1$marital)
View(GSS.divorce.v2)
View(GSS.divorce.v3)
View(GSS.divorce.v4)
View(GSS.divorce.v5)
View(GSS.divorce.v6)
load("GSSdivorce.rda")
GSS.divorce.na <- GSS.divorce
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "educ", "wrkstat",
"spwrksta", "polviews", "happy", "trust", "class", "income", "version")
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
keeps <- c("MARRIED", "DIVORCED", "SEPARATED")
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital==(keeps), ]
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital==keeps, ]
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital=="MARRIED" | "DIVORCED" | "SEPARATED", ]
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital==("MARRIED" | "DIVORCED" | "SEPARATED"), ]
GSS.divorce <- GSS.divorce.na[GSS.divorce.na$marital=="MARRIED" | GSS.divorce.na$marital=="DIVORCED" | GSS.divorce.na$marital=="SEPARATED", ]
View(GSS.divorce)
View(GSS.divorce)
load("GSSdivorce.rda")
GSS.divorce.na <- GSS.divorce
View(GSS.divorce)
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "marital",
"partyid", "hapmar", "denom", "fund", "childs", "age", "educ", "wrkstat",
"spwrksta", "polviews", "happy", "trust", "class", "income", "version")
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
View(GSS.divorce)
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
GSS.divorce <- GSS.divorce.na[GSS.divorce$year>=1996,var_list]
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce.na$marital=="DIVORCED" | GSS.divorce.na$marital=="SEPARATED", ]
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce$marital=="DIVORCED" | GSS.divorce$marital=="SEPARATED", ]
View(GSS.divorce)
library(ggplot2)
premar <- ggplot(GSS.divorce, aes(x="premarsx", y="marital"))
ggplot(GSS.divorce, aes(x="premarsx", y="marital"))
premarcounts <- table(GSS.divorce$marital, GSS.divorce$premarsx)
premar <- ggplot(premarcounts, col=c("darkblue", "lightblue", "lightgreen")
premar <- ggplot(premarcounts, col=c("darkblue", "lightblue", "lightgreen"))
premar <- barplot(premarcounts, col=c("darkblue", "lightblue", "lightgreen"))
premar <- ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar(aes(fill=GSS.divorce$premarsx))
ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar(aes(fill=GSS.divorce$premarsx))
premar <- ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar()
ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar()
premar <- ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar(stat="count")
ggplot(GSS.divorce, x=GSS.divorce$marital, y=GSS.divorce$premarsx) +  geom_bar(stat="count")
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=GSS.divorce$premarsx)) +  geom_bar(fill=GSS.divorce$premarsx)
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=GSS.divorce$premarsx)) +  geom_bar()
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, fill=GSS.divorce$premarsx)) +  hist()
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, fill=GSS.divorce$premarsx))
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=GSS.divorce$premarsx))
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=GSS.divorce$premarsx))
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=GSS.divorce$premarsx)) + geom_bar(stat = "identity")
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=variable)) + geom_bar(stat = "identity") + facet_grid(~samp)
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=value, fill=variable)) + geom_bar(stat = "identity")
ggplot(GSS.divorce, aes(x=GSS.divorce$marital, y=GSS.divorce$premarsx, fill=GSS.divorce$premarsx)) + geom_bar(stat = "identity")
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$premarsx))
View(tab)
colnames(tab) <- c("Marital Status", "Premarital Sex Opinion", "count")
pie_1 <- ggplot(tab, aes(status, premarital)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on premarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, premarital)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on premarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
colnames(tab) <- c("status", "premarital", "count")
ggplot(tab, aes(status, premarital)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on premarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
summary(GSS.divorce$marital)
summary(GSS.divorce$premarsx)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$pornlaw))
colnames(tab) <- c("status", "porn", "count")
pie_2 <- ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on pornography regulation?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on pornography regulation?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$xmarsex))
colnames(tab) <- c("status", "exmar", "count")
pie_3 <- ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on extramarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on extramarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
pie_3 <- ggplot(tab, aes(status, exmar)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on extramarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, exmar)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Opinion on extramarital sex?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$partyid))
colnames(tab) <- c("status", "party", "count")
pie_4 <- ggplot(tab, aes(status, party)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Party identification?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, party)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Party identification?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$happy))
colnames(tab) <- c("status", "happy", "count")
pie_5 <- ggplot(tab, aes(status, happy)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("How happy are you?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, happy)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("How happy are you?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$fund))
colnames(tab) <- c("status", "fund", "count")
pie_6 <- ggplot(tab, aes(status, fund)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Fundamentalism of religion?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, fund)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Fundamentalism of religion?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$class))
colnames(tab) <- c("status", "class", "count")
pie_7 <- ggplot(tab, aes(status, class)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Self-identified class?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, class)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Self-identified class?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$wrkstat))
colnames(tab) <- c("status", "work", "count")
pie_8 <- ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Work status?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, porn)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Work status?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
pie_8 <- ggplot(tab, aes(status, work)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Work status?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, work)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Work status?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$educ))
colnames(tab) <- c("status", "edu", "count")
pie_2 <- ggplot(tab, aes(status, edu)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Years of education?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, edu)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Years of education?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$childs))
colnames(tab) <- c("status", "child", "count")
pie_2 <- ggplot(tab, aes(status, child)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Children?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, child)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Children?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$pornlaw))
colnames(tab) <- c("status", "age", "count")
pie_11 <- ggplot(tab, aes(status, age)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, age)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$age))
colnames(tab) <- c("status", "age", "count")
pie_11 <- ggplot(tab, aes(status, age)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, age)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$sexeduc))
colnames(tab) <- c("status", "sexed", "count")
pie_11 <- ggplot(tab, aes(status, sexed)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, sexed)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Age?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$region))
colnames(tab) <- c("status", "region", "count")
pie_12 <- ggplot(tab, aes(status, region)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Region?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, region)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Region?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
setwd("/Users/Sarah/Documents/Github/data-science-project/")
library(foreign)
load("C:/Users/Sarah/Documents/GitHub/data-science-project/GSScomplete.rda")
var_list <- c("oversamp", "formwt", "wtssall", "sampcode", "sample", "id", "ballot",
"year", "sexeduc", "region", "premarsx", "xmarsex", "pornlaw", "agewed",
"marital", "partyid", "hapmar", "denom", "fund", "childs", "degree",
"age", "divorce", "widowed", "educ", "natdrug", "wrkstat", "spwrksta",
"polviews", "happy", "trust", "class", "income", "version", "reg16",
"family16", "famdif16", "born", "parborn", "income98", "size", "attend",
"relig16", "bible", "helpful", "fair", "consci", "satjob", "satfin",
"abnomore", "absingle", "divlaw", "xmovie", "fefam")
GSS.divorce <- GSS.complete[GSS.complete$year>=1990,var_list]
GSS.divorce$Agecat1<-cut(GSS.divorce$age, c(0,18,25,35,45,55,65,75,85,95))
rm( GSS.complete )
gc()
save(GSS.divorce , file = "GSSdivorce.rda")
load("GSSdivorce.rda")
GSS.divorce <- GSS.divorce[GSS.divorce$marital=="MARRIED" | GSS.divorce$marital=="DIVORCED" | GSS.divorce$marital=="SEPARATED", ]
GSS.divorce$marital <- factor(GSS.divorce$marital)
library(ggplot2)
library(plyr)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$reg16))
colnames(tab) <- c("status", "region16", "count")
pie_20 <- ggplot(tab, aes(status, region16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Region at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, region16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Region at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$family16))
colnames(tab) <- c("status", "family16", "count")
pie_21 <- ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$famdif16))
colnames(tab) <- c("status", "familyif16", "count")
pie_1 <- ggplot(tab, aes(status, familyif16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("If not with both parents, why?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, familyif16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("If not with both parents, why?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, familyif16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("If not with both parents, why?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
tab <- as.data.frame(table(GSS.divorce$marital, GSS.divorce$family16))
colnames(tab) <- c("status", "family16", "count")
pie_21 <- ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
ggplot(tab, aes(status, family16)) +
geom_point(aes(size = count), colour = "green") +
theme_bw() + xlab("Marital Status?") + ylab("Live with both parents at age 16?") + scale_size_continuous(range=c(3,15)) + theme(plot.title = element_text(size = 10), legend.position="none")  + coord_fixed(ratio = 1)
